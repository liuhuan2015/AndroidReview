>[Android 目前稳定高效的UI适配方案](https://mp.weixin.qq.com/s/X-aL2vb4uEhqnLzU5wjc4Q)

android适配最核心的问题有两个：

* 其一，就是适配的效率，即把设计图转化为App界面的过程是否高效
* 其二，如何保证实现UI界面在不同尺寸和分辨率的手机中UI的一致性

在标识尺寸的时候，Android并不推荐我们使用px这个真实像素单位，因为不同的手机之间，分辨率是不同的，比如一个96*96像素的控件在分辨率越来越高的手机上会在整体UI中看起来越来越小。

针对这种情况，Android推荐使用dp作为尺寸单位来适配UI.

#### 适配方案一：dp直接适配
##### 什么是dp？

dp指的是设备独立像素，以dp为尺寸单位的控件，在不同分辨率和尺寸的手机上代表了不同的真实像素，比如在分辨率较低的手机中，可能1dp=1px,而在分辨率较高的手机中，
可能1dp=2px，这样的话，一个96*96dp的控件，在不同的手机中就能表现出差不多的大小了。

##### dp是如何计算的？

有一个计算公式：px = dp * density = dp * (dpi / 160)，系统都是通过这个来进行dp和px的转换。

dpi，像素密度，指的是系统软件上指定的单位尺寸的像素数量，它往往是写在系统出厂配置文件的一个固定值。

在不同分辨率下，dpi将会不同，比如：

<pre>
...	   1080*720	 1920*1080<br>
dpi	      320	    480<br>
dpi/160	        2	      3<br>
</pre>

可以说，通过dp加上自适应布局和weight比例布局可以基本解决不同手机上适配的问题，这基本是最原始的Android适配方案。

这种最原始的适配方案存在两个小问题：
* 第一，这只能保证我们写出来的界面适配绝大部分手机，部分手机仍然需要单独适配，为什么dp只解决了90%的适配问题，因为并不是所有的1080P的手机dpi都是480
* 第二个问题，这种方式无法快速高效的把设计师的设计稿实现到布局代码中，通过dp直接适配，我们只能让UI基本适配不同的手机,但是在设计图和UI代码之间的鸿沟，dp是无法解决的，因为dp不是真实像素。
而且，设计稿的宽高往往和Android的手机真实宽高差别极大，以我们的设计稿为例，设计稿的宽高是375px*750px，而真实手机可能普遍是1080 * 1920。<br>
那么在日常开发中我们是怎么跨过这个鸿沟的呢？<br>
基本都是通过百分比啊，或者通过估算，或者设定一个规范值等等。设计稿上的尺寸单位一般都是px，具体到代码中是多少dp，我们都是需要自己估算的，这会极大地降低我们的生产力，拉低开发效率。

#### 适配方案二：宽高限定符适配
这种适配方案，就是穷举市面上所有的Android手机的宽高像素值，在res下面见一些对应分辨率的values文件夹：
![宽高限定符适配方案]()

设定一个基准的分辨率，其他分辨率都根据这个基准分辨率来计算，在不同的尺寸文件夹内部，根据该尺寸编写对应的dimens文件。

比如以480x320为基准分辨率：
* 宽度为320，将任何分辨率的宽度整分为320份，取值为x1-x320
* 高度为480，将任何分辨率的高度整分为480份，取值为y1-y480

那么对于800*480的分辨率的dimens文件来说，

x1=(480/320)*1=1.5px

x2=(480/320)*2=3px

![宽高限定符适配方案2]()

这个时候，如果我们的UI设计界面使用的就是基准分辨率，那么我们就可以按照设计稿上的尺寸填写相对应的dimens引用了,
而当APP运行在不同分辨率的手机中时，这些系统会根据这些dimens引用去该分辨率的文件夹下面寻找对应的值。这样基本解决了我们的适配问题，而且极大的提升了我们UI开发的效率。

**但是这个方案有一个致命的缺陷，那就是需要精准命中才能适配**，比如1920x1080的手机就一定要找到1920x1080的限定符，否则就只能用统一的默认的dimens文件了。
而使用默认的尺寸的话，UI就很可能变形，简单说，就是**容错机制很差**。

不过这个方案有一些团队用过，可以认为它是一个比较成熟有效的方案了。

#### 适配方案三：今日头条技术团队发布的适配方案

它是通过修改density值，强行把所有不同尺寸分辨率的手机的宽度dp值改成一个统一的值，这样就解决了所有的适配问题。

比如，设计稿宽度是360px，那么开发这边就会把目标dp值设为360dp，在不同的设备中，动态修改density值，从而保证(手机像素宽度)px/density这个值始终是360dp,这样的话，就能保证UI在不同的设备上表现一致了。

这个方案侵入性很低，而且也没有涉及私有API，应该也是极不错的方案，暂时也想不到强行修改density是否会有其他影响，既然有今日头条的大厂在用，稳定性应当是有保证的。

#### 小结

上面的适配方案都是比较成熟的适配方案，有很多开发者在使用，不过他们各自都存在一些缺陷，所以我们使用了上述方案后还需要花费额外的精力着手解决这些可能存在的缺陷。

#### 适配方案四：smallestWidth适配




























